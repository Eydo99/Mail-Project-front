<aside class="sidebar"
       [class.closed]="!isOpen"
       (mouseenter)="onMouseEnter()"
       (mouseleave)="onMouseLeave()">

  <div class="sidebar-inner">

    <!-- ================= HEADER WITH ENHANCED LOGO ================= -->
    <header class="sidebar-header">
      <div class="brand">
        <div class="brand-avatar" aria-hidden="true">
          <!-- Mail/Send icon for Dispatchr -->
          <lucide-icon [img]="Mail"></lucide-icon>
        </div>

        <div class="brand-text">
          <div class="brand-title">Dispatchr</div>
        </div>
      </div>
    </header>

    <!-- ================= PROFILE SECTION ================= -->
    <div class="profile-section">
      <div class="profile-avatar">
        <img *ngIf="profilePhoto; else fallbackAvatar"
             [src]="profilePhoto"
             alt="Profile photo" />

        <ng-template #fallbackAvatar>
          <span class="profile-letter">
            {{ firstName.charAt(0) }}
          </span>
        </ng-template>
      </div>

      <div class="profile-name">
        {{ firstName }} {{ lastName }}
      </div>
    </div>

    <!-- ================= NAV ================= -->
    <nav class="sidebar-nav">
      <ul class="nav-list">

        <li>
          <button class="nav-btn" 
                  [class.nav-btn--active]="currentRoute === 'inbox'"
                  (click)="navigate('inbox')">
            <lucide-icon [img]="Inbox" class="nav-icon"></lucide-icon>
            <span class="label">Inbox</span>
          </button>
        </li>

        <li>
          <button class="nav-btn" 
                  [class.nav-btn--active]="currentRoute === 'priority'"
                  (click)="navigate('priority')">
            <lucide-icon [img]="Star" class="nav-icon"></lucide-icon>
            <span class="label">Priority Inbox</span>
          </button>
        </li>

        <li>
          <button class="nav-btn" 
                  [class.nav-btn--active]="currentRoute === 'sent'"
                  (click)="navigate('sent')">
            <lucide-icon [img]="Send" class="nav-icon"></lucide-icon>
            <span class="label">Sent</span>
          </button>
        </li>

        <li>
          <button class="nav-btn" 
                  [class.nav-btn--active]="currentRoute === 'drafts'"
                  (click)="navigate('drafts')">
            <lucide-icon [img]="FileText" class="nav-icon"></lucide-icon>
            <span class="label">Drafts</span>
          </button>
        </li>

        <li>
          <button class="nav-btn" 
                  [class.nav-btn--active]="currentRoute === 'trash'"
                  (click)="navigate('trash')">
            <lucide-icon [img]="Trash2" class="nav-icon"></lucide-icon>
            <span class="label">Trash</span>
          </button>
        </li>

        <li>
          <button class="nav-btn" 
                  [class.nav-btn--active]="currentRoute === 'folders'"
                  (click)="navigate('folders')">
            <lucide-icon [img]="FolderOpen" class="nav-icon"></lucide-icon>
            <span class="label">Folders</span>
            <span class="folder-badge" *ngIf="totalFolderCount > 0">
              {{ totalFolderCount }}
            </span>
          </button>
        </li>

      </ul>
    </nav>

    <!-- ================= FOOTER ================= -->
    <div class="sidebar-footer">

      <button class="utility-btn" 
              [class.nav-btn--active]="currentRoute === 'contacts'"
              (click)="navigate('contacts')">
        <lucide-icon [img]="Users" class="nav-icon"></lucide-icon>
        <span class="label">Contacts</span>
      </button>

      <button class="utility-btn" 
              [class.nav-btn--active]="currentRoute === 'settings'"
              (click)="navigate('settings')">
        <lucide-icon [img]="Settings" class="nav-icon"></lucide-icon>
        <span class="label">Settings</span>
      </button>

      <button class="new-message-btn" (click)="openCompose()">
        <div class="compose-icon">
          <lucide-icon [img]="Plus"></lucide-icon>
        </div>
        <span class="btn-text">New Message</span>
      </button>

    </div>
  </div>
</aside>